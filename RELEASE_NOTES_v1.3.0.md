# Release Notes - v1.3.0

**ãƒªãƒªãƒ¼ã‚¹æ—¥**: 2025å¹´10æœˆ16æ—¥  
**ã‚¿ã‚¤ãƒ—**: ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—  
**Worker Version ID**: `dc7120be-ba78-422f-ba90-b555f1ac8abc`

---

## ğŸ¯ ã“ã®ãƒªãƒªãƒ¼ã‚¹ã«ã¤ã„ã¦

LINE Messaging APIã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼ˆæœˆé–“500é€šåˆ¶é™ï¼‰å†…ã§å¿«é©ã«é‹ç”¨ã§ãã‚‹ã‚ˆã†ã€è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰ã‚’æœ€é©åŒ–ã—ã¾ã—ãŸã€‚

---

## ğŸš€ ä¸»ãªå¤‰æ›´ç‚¹

### 1. è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰ã®ç„¡æ–™ãƒ—ãƒ©ãƒ³å¯¾å¿œ â­

**å•é¡Œ**: 
- è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰ãŒ2é€šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¦ã„ãŸï¼ˆå‡¦ç†ä¸­+å®Œäº†ï¼‰
- ä¸¡æ–¹ã¨ã‚‚`pushMessage`ã‚’ä½¿ç”¨ã—ã€æœˆé–“ä¸Šé™ã«ã‚«ã‚¦ãƒ³ãƒˆ
- æœˆé–“500é€šã«é”ã™ã‚‹ã¨ã€å®Œäº†é€šçŸ¥ãŒå±Šã‹ãªããªã‚‹

**è§£æ±ºç­–**:
- `replyToken`ã®ã¿ã‚’ä½¿ç”¨ã™ã‚‹è¨­è¨ˆã«å¤‰æ›´
- å‡¦ç†å®Œäº†ã¾ã§å¾…ã£ã¦ã‹ã‚‰ã€1é€šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§çµæœã‚’è¿”ã™
- `replyToken`ã¯æœˆé–“ä¸Šé™ã«ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œãªã„ãŸã‚ã€ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§é‹ç”¨å¯èƒ½

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿**:
- âœ… å®Œäº†é€šçŸ¥ãŒç¢ºå®Ÿã«å±Šãã‚ˆã†ã«ãªã£ãŸ
- âœ… æœˆé–“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ã®å¤§å¹…å‰Šæ¸›
- â±ï¸ å¿œç­”ãŒæ•°ç§’é…ããªã‚‹ï¼ˆGoogle Sheetså‡¦ç†å¾…ã¡ï¼‰
- ğŸ“± ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ1é€šã«ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ã«

**å¤‰æ›´å‰**:
```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼] r ogaiku 50100 Joath 41900 ...
[Bot] â–  è¨˜éŒ²ã‚’å‡¦ç†ã—ã¾ã™
      å››éº»åŠèŠ
      ogaiku, Joath, ...
      å‡¦ç†å®Œäº†ã¾ã§å°‘ã€…ãŠå¾…ã¡ãã ã•ã„...
[Bot] [æˆåŠŸ] è¨˜éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ  â† æœˆé–“ä¸Šé™ã«é”ã™ã‚‹ã¨å±Šã‹ãªã„
```

**å¤‰æ›´å¾Œ**:
```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼] r ogaiku 50100 Joath 41900 ...
ï¼ˆæ•°ç§’å¾…ã¤ï¼‰
[Bot] [æˆåŠŸ] è¨˜éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ
      
      å››éº»åŠèŠ
      ogaiku, Joath, Kawariku, ãªã¹ã¡
      50,100, 41,900, 5,900, 2,100ç‚¹
```

---

### 2. LINE APIå¿œç­”æ¤œè¨¼ã®å¼·åŒ–

**è¿½åŠ æ©Ÿèƒ½**:
- `pushMessage`ã¨`pushMessageWithQuickReply`ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
- ã‚¨ãƒ©ãƒ¼æ™‚ã«è©³ç´°ãªãƒ­ã‚°ã‚’å‡ºåŠ›
- æˆåŠŸæ™‚ã‚‚ãƒ­ã‚°ã«è¨˜éŒ²

**ãƒ¡ãƒªãƒƒãƒˆ**:
- 429ã‚¨ãƒ©ãƒ¼ï¼ˆæœˆé–“ä¸Šé™è¶…éï¼‰ãªã©ã®å•é¡Œã‚’å³åº§ã«è¨ºæ–­å¯èƒ½
- ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“ã«

**ãƒ­ã‚°ä¾‹**:
```
[INFO] pushMessage succeeded to: C1e3dfba17400c0fed2983748553548fc
[ERROR] pushMessage failed: 429 {"message":"You have reached your monthly limit."}
```

---

### 3. é€šçŸ¥è¨­å®šã®æ”¹å–„

**å¤‰æ›´å†…å®¹**:
- ã™ã¹ã¦ã®`pushMessage`ã‹ã‚‰`notificationDisabled: true`ã‚’å‰Šé™¤
- botãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€šå¸¸ã®é€šçŸ¥ã¨ã—ã¦å±Šãã‚ˆã†ã«ãªã£ãŸ

**ç†ç”±**:
- ä»¥å‰ã¯é€šçŸ¥ã‚’ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¦ã„ãŸãŸã‚ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹é€ƒã™å¯èƒ½æ€§ãŒã‚ã£ãŸ
- é€šçŸ¥ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¢ºå®Ÿã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«

---

## âš ï¸ æ—¢çŸ¥ã®åˆ¶é™

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯å¼•ãç¶šã`pushMessage`ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€æœˆé–“ä¸Šé™ï¼ˆ500é€šï¼‰ã®å½±éŸ¿ã‚’å—ã‘ã¾ã™ï¼š

### å½±éŸ¿ã‚’å—ã‘ã‚‹ã‚³ãƒãƒ³ãƒ‰:
1. **`img`** (ç”»åƒè§£æ) - è§£æã«æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚
2. **`ri`** (ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”»åƒç”Ÿæˆ) - ç”»åƒç”Ÿæˆã«æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚
3. **`stimg`** (çµ±è¨ˆç”»åƒç”Ÿæˆ) - ç”»åƒç”Ÿæˆã«æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚
4. **`lk`** (ä¸€æ‹¬çµã³ã¤ã‘) - è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚
5. **AIæ¨æ¸¬ã‚³ãƒãƒ³ãƒ‰** - `replyToken`ãŒæ—¢ã«ä½¿ç”¨æ¸ˆã¿ã®ãŸã‚

### æœˆé–“ä¸Šé™ã«ã¤ã„ã¦:
- **ä¸Šé™**: æœˆé–“500é€šï¼ˆLINEç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- **ãƒªã‚»ãƒƒãƒˆ**: æ¯æœˆ1æ—¥åˆå‰0æ™‚ï¼ˆæ—¥æœ¬æ™‚é–“ï¼‰
- **æ¬¡å›ãƒªã‚»ãƒƒãƒˆ**: 2025å¹´11æœˆ1æ—¥

### ä¸Šé™ã«é”ã—ãŸå ´åˆã®å‹•ä½œ:
- å‡¦ç†è‡ªä½“ã¯æˆåŠŸã™ã‚‹ï¼ˆGoogle Sheetsã¸ã®è¨˜éŒ²ãªã©ï¼‰
- ãŸã ã—å®Œäº†é€šçŸ¥ãŒå±Šã‹ãªã„ï¼ˆ429ã‚¨ãƒ©ãƒ¼ï¼‰
- è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰ï¼ˆ`r`ï¼‰ã¯å½±éŸ¿ã‚’å—ã‘ãªã„ï¼ˆreplyTokenä½¿ç”¨ã®ãŸã‚ï¼‰

---

## ğŸ“Š ä½¿ç”¨é‡ã®ç›®å®‰

### v1.0.0ï¼ˆæœ€é©åŒ–å‰ï¼‰:
- è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰1å›: 2é€šï¼ˆå‡¦ç†ä¸­+å®Œäº†ï¼‰
- 250å›ã®è¨˜éŒ²ã§ä¸Šé™åˆ°é”

### v1.1.0ï¼ˆæœ€é©åŒ–å¾Œï¼‰:
- è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰1å›: 0é€šï¼ˆreplyTokenã®ã¿ï¼‰
- è¨˜éŒ²ã‚³ãƒãƒ³ãƒ‰ã¯ä¸Šé™ã«å½±éŸ¿ãªã—
- ç”»åƒè§£æã‚„ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”Ÿæˆã«ä½¿ç”¨é‡ã‚’é›†ä¸­ã§ãã‚‹

---

## ğŸ”§ æŠ€è¡“çš„ãªè©³ç´°

### å¤‰æ›´ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰:
- `handleQuickRecord()` - è¨˜éŒ²å‡¦ç†ãƒ¡ã‚½ãƒƒãƒ‰
- `pushMessage()` - ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¤œè¨¼è¿½åŠ 
- `pushMessageWithQuickReply()` - ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¤œè¨¼è¿½åŠ 

### è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³:
```javascript
if (replyToken) {
  // replyTokenãŒã‚ã‚‹å ´åˆ: åŒæœŸå‡¦ç†
  const result = await processRecord();
  await lineAPI.replyMessage(replyToken, result);  // ç„¡æ–™
} else {
  // replyTokenãŒãªã„å ´åˆ: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
  await lineAPI.pushMessage(groupId, "å‡¦ç†ä¸­...");  // æœ‰æ–™
  ctx.waitUntil(async () => {
    const result = await processRecord();
    await lineAPI.pushMessage(groupId, result);  // æœ‰æ–™
  });
}
```

---

## ğŸ‰ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ä»Šå¾Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚‚æœ€é©åŒ–äºˆå®š:
- [ ] `img` - ç”»åƒè§£æã‚³ãƒãƒ³ãƒ‰
- [ ] `ri` - ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”»åƒç”Ÿæˆ
- [ ] `stimg` - çµ±è¨ˆç”»åƒç”Ÿæˆ
- [ ] `lk` - ä¸€æ‹¬çµã³ã¤ã‘

---

## ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

ãƒã‚°å ±å‘Šã‚„æ©Ÿèƒ½è¦æœ›ã¯ã€GitHubã®Issuesã«ãŠé¡˜ã„ã—ã¾ã™:
https://github.com/ogaiku-wospe/mahjong-line-bot/issues

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [CHANGELOG.md](./CHANGELOG.md) - è©³ç´°ãªå¤‰æ›´å±¥æ­´
- [README.md](./README.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- [GitHub Releases](https://github.com/ogaiku-wospe/mahjong-line-bot/releases/tag/v1.3.0)
